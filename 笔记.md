# store

## Project setup

```
npm install
```

### 开发环境打包

```
npm run serve
```

### 生产环境打包

```
npm run build
```

### ESLint语法检查和修正

```
npm run lint
```
### 生成打包报告

```
npm run build --report
```
### Customize configuration

See [Configuration Reference](https://cli.vuejs.org/config/).

### 生成码云公钥

- 输入如下命令，按 3 次回车：ssh-keygen -t rsa -C xxxxx@xxxxx.com(这是码云的邮箱地址)
- 查看公钥：cat ~/.ssh/id_rsa.pub

### Git 全局配置

- git config --global user.name "xxx"
  git config --global user.email "xxx@xxx"

### 命令行方式提交到码云

- git add
- git commit -m "提交信息"
- git push

````
代码块语法```
````

### 使用 mint-ui mui icon 字体图标

### 样式不显示可能是

- 类名不对
- 盒子高度为 0
- 权重不够，加 !imoprant

### vue 使用 vue-axios

- 安装 cnpm install --save axios vue-axios
- 在 main.js 页面引用
  - import axios from 'axios'
  - import VueAxios from 'vue-axios'
  - Vue.use(VueAxios, axios)
- 设置基址 axios.defaults.baseURL = 'http://localhost:3000/'
- 使用 this.axios

### 后台解决跨域问题

```
    app.all("*", function(req, res, next) {
    if (!req.get("Origin")) return next();
    // use "*" here to accept any origin
    res.set("Access-Control-Allow-Origin", "*");
    res.set("Access-Control-Allow-Methods", "GET");
    res.set("Access-Control-Allow-Headers", "X-Requested-With, Content-Type");
    // res.set('Access-Control-Allow-Max-Age', 3600);
    if ("OPTIONS" === req.method) return res.send(200);
    next();
    });
```

### 使用 vue 过滤器格式化时间

- 1.安装插件 npm i moment -S
- 2.定义过滤器

```
//dataFormat为过滤器名字，dataStr接收传入的date，pattern接受传入的"YYYY-MM-DD"，若没有，为默认值'YYYY-MM-DD HH:mm:ss'
Vue.filter('dataFormat', function (dataStr, pattern = 'YYYY-MM-DD HH:mm:ss') {
    return monent(dataStr).format(pattern)
})
```

- 3.使用

```
<div>{{date | dataFormat("YYYY-MM-DD")}}</div>
```

### 切换底部栏出现滚动条，可以尝试以下方法：

- overflow: hidden ;
- width: 100%;

### 使用 mockjs 模拟后端接口

```
- npm i mockjs
- import Mock from 'mockjs'
- Mock.mock(url, data) //url为拦截的ajax请求，data为返回的数据
```

### 组件间传值的几种方式

### 弹性布局的几个属性 align-items align-content justify-content align-self 需要配合 display: flex;使用

- align-items（在父元素设置）属性适用于所有的 flex 容器，它是用来设置每个 flex 元素在侧轴上的默认对齐方式
- align-items（在父元素设置）和 align-content 有相同的功能，align-content 属性只适用于多行的 flex 容器
- align-items（在父元素设置）是针对一行的情况进行排列，align-content 是针对 flex 容器里面多轴(多行)的情况
- align-self（在子元素设置） 定义 flex 子项单独在侧轴（纵轴）方向上的对齐方式。
- justify-content（在父元素设置） 设置子元素在主轴（横轴）的对齐方式。
  - 1.flex-start(默认值) 左对齐
  - 2.flex-end 右对齐
  - 3.center 居中
  - 4.sapce-between 两端对齐，子元素之间的间距相等
  - 5.space-around 每个子元素两侧的间距相等。

### 加浏览器前缀做兼容处理

-moz 火狐，-ms IE，-webkit 谷歌， -o Opera

### 为什么需要用 session？

客户端发送请求到服务端建立一个连接，请求得到响应后连接即中断，服务器端不会记录状态，因此服务器端想要确定是哪个客户端提交过来的请求，就必须要借助一些东西去完成：session 和 cookies。

### Cookie 和 Session 区别

1、cookie 数据存放在客户的浏览器上，session 数据放在服务器上。
2、cookie 不是很安全，别人可以分析存放在本地的 COOKIE 并进行 COOKIE 欺骗 考虑到安全应当使用 session。
3、session 会在一定时间内保存在服务器上。当访问增多，会比较占用你服务器的性能 考虑到减轻服务器性能方面，应当使用 COOKIE。
4、单个 cookie 保存的数据不能超过 4K，很多浏览器都限制一个站点最多保存 20 个 cookie。


### 前端要携带 cookie 到服务端，需要三个条件：

1. Access-Control-Allow-Origin 不能为\*，应为具体域名
2. 服务端 Access-Control-Allow-Credentials 应为 true
3. 客户端 XMLHttpRequest 的 withCredentials=true

### 关于 cookie 丢失 session 取值为 undefined 的问题

虽然 axios 配置了 axios.defaults.withCredentials = true，由于我使用了 Mockjs，Mockjs 会拦截所有 ajax 请求，覆盖 axios 配置，对于跨域请求，Mockjs 是不携带 cookie 的，如果需要携带 cookie 配置 Mock.XHR.prototype.withCredentials = true 即可

### 项目优化

#### 1. keep-alive 缓存组件对象：keep-alive 是 Vue 的内置组件，能在组件切换过程中将状态保留在内存中，防止重复渲染 DOM。

```
<keep-alive>
    <!--这里是会被缓存的组件-->
    <router-view></router-view>
</keep-alive>
```

#### 2. 路由组件懒加载

```
    {
        path: '/login',
        component: () => import('../components/Login/Login.vue')
    }
```

#### 3. 图片懒加载 vue-lazyload插件

```
1. 安装插件：npm install vue-lazyload --save-dev
2.main.js引入插件：
 import VueLazyLoad from 'vue-lazyload'
 Vue.use(VueLazyLoad,{
     preLoad: 1.3,
     error:'./static/error.png',
     loading:'./static/loading.png',
     attempt: 1
 })
 3.vue文件中将需要懒加载的图片绑定 v-bind:src 修改为 v-lazy
  <img class="item-pic" v-lazy="newItem.picUrl"/>
 4.vue文件中需要懒加载的背景图片，v-lazy:background-image="imgUrl"
```
#### 4. 日期格式化 使用data-fns代替moment
1. 安装 npm install --save date-fns
2. 引入并自定义过滤器
import format from 'date-fns/format'
 Vue.filter('date-format', function(dataStr, pattern = 'YYYY-MM-DD HH:mm:ss') {
    return format(dataStr,pattern)
 })
3. 使用
<div  class="time">{{rating.rateTime|date-format}}</div>
#### 5.md5加密(blueimp-md5)

#### 6.优化登录创建防攻击验证码 node使用svg-captcha

#### 7.解决移动端300毫秒点击延迟
#### 7.1 禁用缩放并设置视口宽度为物理宽度 在html头部设置meta标签
```
<meta name="viewport" content="width=device-width,initial-scale=1,maximum-scale=1,user-scalable=no">
```
#### 7.2 FastClick
##### 在vue中使用FastClick
- 安装
```
npm install fastclick --save
```
- 引入
```
import FastClick from 'fastclick'
```
- 使用
```
FastClick.attach(document.body);
```
##### 在js中使用FastClick
```
<script type='application/javascript' src='/path/to/fastclick.js'></script>
// 使用了jquery的时候
   $(function() {
        FastClick.attach(document.body);
    });
// 使用原生js的时候
    if ('addEventListener' in document) {
        document.addEventListener('DOMContentLoaded', function() {
            FastClick.attach(document.body);
        }, false);
    }
```
#### 8.屏幕适配px2vw 单位转化(使用postcss-px-to-viewport插件)
- 安装
```
npm i postcss-px-to-viewport --save-dev
```
- 配置postcss.config.js
```
module.exports = {
    plugins: {
      autoprefixer: {},
      "postcss-px-to-viewport": {
        viewportWidth: 375, //视口的宽度，对应的时设计稿的宽度/2，一般为750
        viewportHeight: 667, //视口的高度，对应的是设计稿的高度（也可以不配置）
        unitPrecision: 5, //指定‘px’转换为视口单位值的小数位数（很多时候无法整除）
        viewportUnit: 'vw', //指定需要转换成的视口单位，建议使用vw
        selectorBlankList: ['ignore', 'tab-bar'], //指定不需要转换的类
        minPixelValue: 1, //小于或等于‘1px’不转换为视口单位
        mediaQuery: true,//允许在媒体查询中转换为‘px’,false为不使用媒体查询转换
        exclude:[/HomeContainer/]  //不需要转化的组件文件名正则，必须是正则表达式
      }
    }
}
```
#### 9.生产环境移除console(使用babel-plugin-transform-remove-console插件)
- 安装
```
npm install babel-plugin-transform-remove-console --save-dev
```
- 配置babel.config.js
```
const prodPlugins = []
if(process.env.NODE_ENV === 'production') {
  prodPlugins.push("transform-remove-console")
}

module.exports = {
    presets: ['@vue/cli-plugin-babel/preset'],
    plugins: [
        ...prodPlugins
    ]
}
```
### 问题与解决
 - 1. CSS minification error: postcss-svgo: Error in parsing SVG: Unquoted attribute value
 原因是引入的 mui.css有svg，这里提示打包出来的静态资源中的css文件中的svg引用必须使用双引号

